{"pc":{"type":"Grid","model":{"rows":[{"cells":[{"class":"bg-primary","component":{"type":"Text","model":{"text":"<h1>Order Form</h1>","_internalName":"Text2"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"class":"to-hide","component":{"type":"Text","model":{"text":"<h4>Customer Details</h4>","_internalName":"Text3"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"class":"order-info","component":{"type":"Grid","model":{"rows":[{"cells":[{"component":{"type":"SingleLineText","model":{"title":{"text":"First Name","visible":false},"orientation":"Horizontal","required":false,"cHint":"First Name","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"type":"Anything","wrap":true,"_internalName":"FirstName"}},"alignment":"Justify","columns":{"width":6}},{"component":{"type":"SingleLineText","model":{"title":{"text":"Last Name","visible":false},"orientation":"Horizontal","required":false,"cHint":"Last Name","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"type":"Anything","wrap":true,"_internalName":"LastName"}},"alignment":"Justify","columns":{"width":6}}]},{"cells":[{"component":{"type":"SingleLineText","model":{"title":{"text":"Email","visible":false},"orientation":"Horizontal","required":false,"cHint":"Email","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"type":"E-mail","wrap":true,"_internalName":"Email","pattern":"^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$","error":"This field must contain a valid e-mail address."}},"alignment":"Justify","columns":{"width":6}},{"component":{"type":"MaskedInput","model":{"title":{"text":"Phone","visible":false},"orientation":"Horizontal","required":false,"font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"mask":"+0 (000) 000 00 00","wrap":true,"_internalName":"Phone"}},"alignment":"Justify","columns":{"width":6}}]}],"stacked":"md","class":"bg-secondary","_internalName":"Grid1"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"class":"to-hide","component":{"type":"Text","model":{"text":"<h4>Shipping Details</h4>","_internalName":"Text6"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"class":"order-info","component":{"type":"Grid","model":{"rows":[{"cells":[{"component":{"type":"SingleLineText","model":{"title":{"text":"Street","visible":false},"orientation":"Horizontal","required":false,"cHint":"Street","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"type":"Anything","wrap":true,"_internalName":"Street"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"component":{"type":"SingleLineText","model":{"title":{"text":"City","visible":false},"orientation":"Horizontal","required":false,"cHint":"City","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"type":"Anything","wrap":true,"_internalName":"City"}},"alignment":"Justify","columns":{"width":6}},{"component":{"type":"SingleLineText","model":{"title":{"text":"State","visible":false},"orientation":"Horizontal","required":false,"cHint":"State / Province","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"type":"Anything","wrap":true,"_internalName":"State"}},"alignment":"Justify","columns":{"width":6}}]},{"cells":[{"component":{"type":"SingleLineText","model":{"title":{"text":"Country","visible":false},"orientation":"Horizontal","required":false,"cHint":"Country","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"type":"Anything","wrap":true,"_internalName":"Country"}},"alignment":"Justify","columns":{"width":6}},{"component":{"type":"SingleLineText","model":{"title":{"text":"ZIP Code","visible":false},"orientation":"Horizontal","required":false,"cHint":"ZIP Code","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"type":"Anything","wrap":true,"_internalName":"ZIPCode"}},"alignment":"Justify","columns":{"width":6}}]}],"stacked":"md","class":"bg-secondary","_internalName":"Grid2"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"class":"to-hide","component":{"type":"Text","model":{"text":"<h4>Order Details</h4>","_internalName":"Text12"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"class":"order-info","component":{"type":"Grid","model":{"rows":[{"cells":[{"component":{"type":"DataTable","model":{"columns":[{"_internalName":"Item","title":"Item","required":true,"type":"Dropdown","options":"Pen Holder\nAlarm Clock\nIce Tray","selection":"Single"},{"_internalName":"Quantity","title":"Quantity","required":true,"type":"Number","min":1,"max":10,"decimals":0,"format":"n0","step":1},{"_internalName":"Price","title":"Price ($)","required":false,"type":"Number","decimals":2,"format":"c2","step":1},{"_internalName":"Total","title":"Total","required":false,"type":"Number","decimals":2,"format":"c2","step":1}],"newLine":"Top","delete":"Last","_internalName":"ItemsList"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"component":{"type":"Number","model":{"title":{"text":"Total","visible":true},"orientation":"Horizontal","required":false,"font":{"style":"Normal","weight":"Bold"},"cWidth":150,"cFont":{"style":"Normal","weight":"Normal"},"decimals":2,"format":"c2","step":1,"wrap":true,"_internalName":"Total1"}},"alignment":"Right","columns":{"width":12}}]},{"cells":[{"component":{"type":"Button","model":{"text":"Order Now!","type":"Primary","click":"return fd.save();","_internalName":"Button1"}},"alignment":"Justify","columns":{"width":12}}]}],"stacked":"md","class":"bg-secondary","_internalName":"Grid3"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"class":"payment","component":{"type":"Grid","model":{"rows":[{"cells":[{"component":{"type":"Text","model":{"text":"<h4 style=\"text-align:center;\">Thank you for the order! </h4><h5 style=\"text-align:center;\">We have already started to work on your order! </h5><h5 style=\"text-align:center;\">Please proceed with the payment.</h5>","_internalName":"Text13"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"component":{"type":"HTML","model":{"content":"<div id=\"smart-button-container\">\r\n    <div id=\"invoiceidDiv\" style=\"text-align: center; display: none;\"><label for=\"invoiceid\"> </label><input name=\"invoiceid\" maxlength=\"127\" type=\"text\" id=\"invoiceid\" value=\"\" ></div>\r\n      <p id=\"invoiceidError\" style=\"visibility: hidden; color:red; text-align: center;\">Please enter an Invoice ID</p>\r\n    <div style=\"text-align: center; margin-top: 0.625rem;\" id=\"paypal-button-container\"></div>\r\n  </div>\r\n ","_internalName":"HTML1"}},"alignment":"Justify","columns":{"width":12}}]}],"stacked":"md","_internalName":"Grid4"}},"alignment":"Justify","columns":{"width":12}}]}],"stacked":"md"}},"phone":null,"tablet":null,"js":"window.fd = fd;\r\nwindow.$ = $;\r\nwindow.amount = amount;\r\n\r\nvar amount = 0;\r\n//we store prices in the object\r\nvar merch = {};\r\n\r\nmerch['Pen Holder'] = 9.99;\r\nmerch['Ice Tray'] = 19.99;\r\nmerch['Alarm Clock'] = 4.99;\r\n\r\nfd.rendered(function () {\r\n    //hide payment section\r\n    $('.payment').hide()\r\n   \r\n    fd.field('Total1').disabled = true;\r\n    \r\n    fd.control('ItemsList').columns[2].editable = function(){return false};\r\n    fd.control('ItemsList').columns[3].editable = function(){return false};\r\n    \r\n    fd.control('ItemsList').addValidator({\r\n        name: 'ItemsList validator',\r\n        error: 'Enter at least one record into the table',\r\n        validate: function(value) {\r\n            //change this number to make more records required\r\n            if (value.length < 1) {\r\n                return false;\r\n            }\r\n    \r\n            return true;\r\n        }\r\n    });\r\n\r\n    fd.control('ItemsList').$on('change', function(value) {\r\n        console.log(value); // DataTable's value\r\n        if(value){\r\n            //these changes are not manual\r\n            manualChange = false;\r\n            for(var i = 0; i < value.length; i++){\r\n            value[i].Price = merch[value[i].Item];\r\n            }\r\n            //refresh to update all values\r\n            fd.control('ItemsList').widget.refresh()\r\n        }\r\n        \r\n        //variable to count Order Total\r\n        var orderTotal = 0.0;\r\n\r\n        //if there are records in the table\r\n        var isTableModified = null;\r\n        if(value){\r\n            //go through each one by one\r\n            for (var i = 0; i < value.length; i++){\r\n                //if this record has Amount and UnitPrice\r\n                if(value[i].Quantity && value[i].Price){\r\n                    //set LineTotal to their product\r\n                    var cost = value[i].Quantity * value[i].Price;\r\n\r\n                    if (value[i].Total != cost) {\r\n                        if (!isTableModified) {\r\n                            isTableModified = Object.assign({}, value);\r\n                        }\r\n                        value[i].Total = cost;\r\n                    }\r\n                }\r\n\r\n                //add Total to the Order Total\r\n                orderTotal += parseFloat(value[i].Total);\r\n            }\r\n        }\r\n\r\n        //here we refresh the table\r\n        if (isTableModified) {\r\n            fd.control('ItemsList').value = value;\r\n            fd.control('ItemsList').widget.refresh();\r\n        }\r\n\r\n        //we set Order Total field to sum of Totals\r\n        fd.field('Total1').value = orderTotal;\r\n    });\r\n    \r\n    \r\n});\r\n\r\nfd.beforeSave(function(data) {\r\n    var amount = data.Total1;\r\n    console.log(amount)\r\n    $('.payment').show();\r\n   // $('.order-info').hide();\r\n    \r\n    var script = document.createElement('script');\r\n    script.type = 'text/javascript';\r\n    script.src = 'https://www.paypal.com/sdk/js?client-id=AQ7P3z6oe-fhuUWaRXJnAKAA9x3KJRIY1tNRRooLpBcHK0cj1jJ3N32mse4fLzdKNOrI-cqW0iidCFzo';\r\n    script.setAttribute('data-sdk-integration-source', 'button-factory');\r\n    script.onload = function(){\r\n    var invoiceid = document.querySelector('#smart-button-container #invoiceid');\r\n    var invoiceidError = document.querySelector('#smart-button-container #invoiceidError');\r\n    var invoiceidDiv = document.querySelector('#smart-button-container #invoiceidDiv');\r\n\r\n\r\n    if (invoiceidDiv.firstChild.innerHTML.length > 1) {\r\n      invoiceidDiv.style.display = \"block\";\r\n    }\r\n\r\n\r\n    function validate(event) {\r\n      return event.value.length > 0;\r\n    }\r\n    \r\n    var orderDescription = '';\r\n    if(orderDescription === '') {\r\n      orderDescription = 'New order';\r\n    }\r\n    \r\n    paypal.Buttons({\r\n      style: {\r\n        color: 'gold',\r\n        shape: 'rect',\r\n        label: 'paypal',\r\n        layout: 'vertical',\r\n        \r\n      },\r\n\r\n      onInit: function (data, actions) {\r\n      //  actions.disable();\r\n\r\n        if(invoiceidDiv.style.display === \"block\") {\r\n          elArr.push(invoiceid);\r\n        }\r\n\r\n            if (amount) {\r\n              actions.enable();\r\n            } else {\r\n              actions.disable();\r\n            }\r\n      },\r\n\r\n      onClick: function () {\r\n\r\n        if (invoiceid.value.length < 1 && invoiceidDiv.style.display === \"block\") {\r\n          invoiceidError.style.visibility = \"visible\";\r\n        } else {\r\n          invoiceidError.style.visibility = \"hidden\";\r\n        }\r\n\r\n      },\r\n\r\n      createOrder: function (data, actions) {\r\n          var priceTotal = parseFloat(amount).toFixed(2);\r\n\r\n          \r\n    return actions.order.create({\r\n          purchase_units: [{\r\n            description: orderDescription,\r\n            amount: {\r\n              currency_code: 'USD',\r\n              value: priceTotal\r\n            }\r\n          }]\r\n        });\r\n      },\r\n\r\n      onApprove: function (data, actions) {\r\n        return actions.order.capture().then(function (details) {\r\n          alert('Transaction completed by ' + details.payer.name.given_name + '!');\r\n        });\r\n      },\r\n\r\n      onError: function (err) {\r\n        console.log(err);\r\n      }\r\n    }).render('#paypal-button-container');\r\n    };\r\n    const head = document.getElementsByTagName('head')[0];\r\n    head.appendChild(script); \r\n});","css":".fd-form button.fd-button.btn.btn-primary {\n    font-weight: 500 !important;\n    color: white !important;\n}\n\n.fd-form h1, .fd-form .h1 {\n    font-size: min(6.5vw, 2.34375rem)!important;\n    text-align: center!important;\n    color: #ffff!important;\n}\n\n.fd-form h4, .fd-form .h4 {\n    font-size: min(4.5vw, 1.40625rem)!important;\n    padding-top: 20px!important;\n    padding-bottom: 4px!important;\n    display: flex!important;\n    flex-direction: row!important;\n}\n\n.fd-form h4:before, .fd-form h4:after{\n  content: \"\";\n  flex: 1 1;\n  border-bottom: 1px solid;\n  margin: auto;\n}\n.fd-form h4:before {\n  margin-right: 10px\n}\n.fd-form h4:after {\n  margin-left: 10px\n}\n\n.fd-form p{\n    font-size: min(3vw, .9375rem)!important;\n    text-align: center!important;\n}\n\nspan.k-select {\n    display: none !important;\n}\n","theme":{"primary":"#ffc439","bodyText":"#373A3C","bodyBackground":"#ffffff","fontFamily":null,"fontType":0,"fontSize":15,"fontWeight":400,"borderThickness":1,"borderRadius":8,"shadow":true,"themeId":"b707776c0553e23dfdc740ae7e0843ea"},"timezone":"Asia/Yekaterinburg","culture":"en-US","notifySubscribers":false,"thankYouMessage":null,"redirectURL":null,"hideAfterSubmission":false,"submissionTimeout":0,"authentication":0,"singleSubmissionPerUser":false,"allowEditingSubmission":false,"restrictAccess":false,"azureADTenant":null,"azureADObjects":[],"azureB2CProperties":null,"version":"1.0.2"}