{"pc":{"type":"Grid","model":{"rows":[{"cells":[{"class":"bg-primary","component":{"type":"Text","model":{"text":"<h1>Expense Reimbursement Form</h1>","_internalName":"Text2"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"padding":[30,null,null,null],"component":{"type":"Text","model":{"text":"<h4>Employee Information</h4>","_internalName":"Text3"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"padding":[5,null,null,null],"class":"bg-secondary","component":{"type":"Grid","model":{"rows":[{"cells":[{"component":{"type":"SingleLineText","model":{"title":{"text":"First Name","visible":false},"orientation":"Horizontal","required":false,"cHint":"First Name","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"type":"Anything","wrap":true,"_internalName":"FirstName"}},"alignment":"Justify","columns":{"width":6}},{"component":{"type":"SingleLineText","model":{"title":{"text":"Family Name","visible":false},"orientation":"Horizontal","required":false,"cHint":"Family Name","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"type":"Anything","wrap":true,"_internalName":"FamilyName"}},"alignment":"Justify","columns":{"width":6}}]},{"cells":[{"component":{"type":"DropDown","model":{"title":{"text":"Department","visible":false},"orientation":"Horizontal","required":false,"cHint":"Department","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"dataSource":"StaticList","options":"Production.\r\nResearch and Development\r\nProcurement and Sourcing\r\nMarketing \r\nHuman Resource Management\r\nAccounting and Finance","selection":"Single","wrap":true,"_internalName":"Department"}},"alignment":"Justify","columns":{"width":6}},{"component":{"type":"SingleLineText","model":{"title":{"text":"Manager","visible":false},"orientation":"Horizontal","required":false,"cHint":"Manager Name","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"type":"Anything","wrap":true,"_internalName":"ManagerName"}},"alignment":"Justify","columns":{"width":6}}]}],"stacked":"md","_internalName":"Grid2"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"padding":[15,null,null,null],"component":{"type":"Text","model":{"text":"<h4>Expense Information</h4>","_internalName":"Text6"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"padding":[5,null,null,null],"class":"bg-secondary","component":{"type":"Grid","model":{"rows":[{"cells":[{"component":{"type":"Text","model":{"text":"<h6>Expense Period:</h6>","_internalName":"Text8"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"component":{"type":"Date","model":{"title":{"text":"From","visible":false},"orientation":"Horizontal","required":false,"cHint":"From","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"wrap":true,"_internalName":"From"}},"alignment":"Justify","columns":{"width":6}},{"component":{"type":"Date","model":{"title":{"text":"To","visible":false},"orientation":"Horizontal","required":false,"cHint":"To","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"wrap":true,"_internalName":"To"}},"alignment":"Justify","columns":{"width":6}}]},{"cells":[{"component":{"type":"SingleLineText","model":{"title":{"text":"Business Purpose","visible":false},"orientation":"Horizontal","required":false,"cHint":"Business Purpose","font":{"style":"Normal","weight":"Semibold"},"cFont":{"style":"Normal","weight":"Normal"},"type":"Anything","wrap":true,"_internalName":"BusinessPurpose"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"padding":[15,null,null,null],"component":{"type":"Text","model":{"text":"<h6 style=\"text-align:center;\">Itemized Expenses</h6>","_internalName":"Text9"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"component":{"type":"DataTable","model":{"columns":[{"_internalName":"Description","title":"Description","required":false,"type":"String"},{"_internalName":"Date","title":"Date","required":false,"type":"Date"},{"_internalName":"Category","title":"Category","required":false,"type":"Dropdown","options":"Advertising Expenses \r\nBusiness Vehicle(s) \r\nPayroll \r\nEmployee Benefits \r\nMeals & Entertainment Expenses \r\nOffice Expenses \r\nOffice Supplies \r\nProfessional Services","selection":"Single"},{"_internalName":"Amount","title":"Amount","required":false,"type":"Number","min":0,"decimals":2,"format":"c2","step":1}],"newLine":"Top","delete":"Last","_internalName":"DataTable1"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"component":{"type":"Number","model":{"width":60,"title":{"text":"Total:","visible":true},"orientation":"Horizontal","required":false,"font":{"style":"Normal","weight":"Semibold"},"cWidth":100,"cFont":{"style":"Normal","weight":"Normal"},"decimals":2,"format":"c2","step":1,"wrap":true,"_internalName":"Total"}},"alignment":"Right","columns":{"width":12}}]}],"stacked":"md","_internalName":"Grid1"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"padding":[20,null,null,null],"component":{"type":"Grid","model":{"rows":[{"cells":[{"component":{"type":"Text","model":{"text":"<h5>Signature:</h5>","_internalName":"Text10"}},"alignment":"Justify","columns":{"width":2}},{"component":{"type":"Signature","model":{"width":300,"height":150,"inkColor":"#000000","_internalName":"Signature"}},"alignment":"Left","columns":{"width":10}}]}],"stacked":"md","_internalName":"Grid1"}},"alignment":"Justify","columns":{"width":12}}]},{"cells":[{"padding":[15,null,null,null],"component":{"type":"Submit","model":{"text":"SEND REPORT","type":"Primary","click":"return fd.save();","_internalName":"Submit1"}},"alignment":"Center","columns":{"width":12}}]}],"stacked":"md"}},"phone":null,"tablet":null,"js":"fd.rendered(function () {\r\n    fd.field('Total').disabled = true;\r\n    \r\n    //requires a valid time interval to be entered\r\n    fd.validators.push({\r\n        name: 'PeriodValidation',\r\n        error: \"Select valid period\",\r\n        validate: function(value) {\r\n            if (fd.field('From').value > fd.field('To').value)\r\n                return false;\r\n    \r\n            return true;\r\n        }\r\n    });\r\n    //require a user to add at least one record to the data table\r\n    fd.validators.push({\r\n        name: 'ExpenseItemsValidation',\r\n        error: \"Add at least one expense item\",\r\n        validate: function(value) {\r\n            if (fd.control('DataTable1').value.length < 1)\r\n                return false;\r\n    \r\n            return true;\r\n        }\r\n    });\r\n    \r\n    //require a user to sign the form\r\n    fd.validators.push({\r\n        name: 'SignatureValidation',\r\n        error: \"Signature is required\",\r\n        validate: function(value) {\r\n            if (fd.control('Signature').value == null)\r\n                return false;\r\n    \r\n            return true;\r\n        }\r\n    });\r\n    \r\n    //calculates totals \r\n    fd.control('DataTable1').$on('change', function(value) {\r\n        //variable to count Order Total\r\n        var expenseTotal = 0.0;\r\n\r\n        //if there are records in the table\r\n        if(value){\r\n            //go through each one by one\r\n            for (var i = 0; i < value.length; i++){\r\n                if(value[i].Amount){\r\n                    expenseTotal += value[i].Amount;\r\n                    \r\n                }\r\n            }\r\n        }\r\n        fd.field('Total').value = parseFloat(expenseTotal);\r\n    });\r\n\r\n});\r\n/*****************************************************************************\r\nThe JavaScript code from this section will be executed while loading\r\nthe current form.\r\n\r\nThe following predefined variables can be utilized in the code:\r\n\r\nfd  - instance of the current form\r\n$   - jQuery object\r\n\r\n==============================================================================\r\n\r\nfd.rendered(function () {\r\n    // This code is executed once the form is rendered\r\n\r\n    // Hide State field for all values of Country field except 'USA'\r\n    function updateStateVisibility() {\r\n        var stateContainer = $(fd.field('State').$el).closest('.form-group');\r\n        if (fd.field('Country').value === 'USA') {\r\n            stateContainer.show();\r\n        } else {\r\n            stateContainer.hide();\r\n        }\r\n    }\r\n\r\n    // Set initial State visibility\r\n    updateStateVisibility();\r\n\r\n    // Update State visibility after changing Country\r\n    fd.field('Country').$on('change', updateStateVisibility)\r\n});\r\n\r\nfd.beforeSave(function () {\r\n    // This code is exeuted before saving the form and\r\n    // may return Promise. The saving does not proceed until\r\n    // the Promise is resolved. If the Promise is rejected,\r\n    // the saving interrupts. This is the appropriate place\r\n    // for adding custom validation.\r\n\r\n    // Prevent saving if Start Date is greater than End Date\r\n    if (fd.field('StartDate').value > fd.field('EndDate').value) {\r\n        throw Error('Start Date must not be greater than End Date.');\r\n    }\r\n});\r\n\r\nfd.saved(function (result) {\r\n    // This code is executed after saving the form\r\n\r\n    // Forwarding users to specific URL\r\n    window.location = '--- Some URL ---';\r\n});\r\n\r\n*****************************************************************************/\r\n\r\n    \r\n","css":".fd-form span.k-numeric-wrap.k-state-disabled span.k-select {\r\n    display:none;\r\n}\r\n.fd-form span.k-widget.k-numerictextbox.form-control, .k-state-disabled, .k-widget[disabled] {\r\n    border: none !important;\r\n    opacity: 1 !important;\r\n    filter: none !important;\r\n}\r\n\r\n.fd-form .btn-primary{\r\n    font-weight: 700 !important;\r\n}\r\n\r\n.fd-form .logo-img{\r\n    width: min(20vw, 120px);\r\n    min-width: 70px;\r\n}\r\n\r\n.fd-form h1, .fd-form .h1 {\r\n    font-size: min(6.5vw, 2.34375rem)!important;\r\n    text-align: center!important;\r\n    color: white!important;\r\n}\r\n\r\n.fd-form h4, .fd-form .h4 {\r\n    font-size: min(4.5vw, 1.40625rem)!important;\r\n    padding-top: 4px!important;\r\n    padding-bottom: 4px!important;\r\n    display: flex!important;\r\n    flex-direction: row!important;\r\n}\r\n\r\n.fd-form h4:before, .fd-form h4:after{\r\n  content: \"\";\r\n  flex: 1 1;\r\n  border-bottom: 1px solid;\r\n  margin: auto;\r\n}\r\n.fd-form h4:before {\r\n  margin-right: 10px\r\n}\r\n.fd-form h4:after {\r\n  margin-left: 10px\r\n}\r\n\r\n.fd-form p{\r\n    font-size: min(3vw, .9375rem);\r\n    text-align: center;\r\n}\r\n","theme":{"primary":"#8764B8","bodyText":"#333333","bodyBackground":"#e5e0ec96","fontFamily":null,"fontType":0,"fontSize":15,"fontWeight":400,"borderThickness":0,"borderRadius":8,"shadow":true,"themeId":null},"timezone":"Asia/Yekaterinburg","culture":"ru","notifySubscribers":false,"thankYouMessage":null,"redirectURL":null,"hideAfterSubmission":false,"submissionTimeout":0,"authentication":0,"singleSubmissionPerUser":false,"allowEditingSubmission":false,"restrictAccess":false,"azureADTenant":null,"azureADObjects":[],"azureB2CProperties":null,"version":"1.0.2"}